@model ScendMvc.Models.Proposal

@{
    ViewData["Title"] = "Edit";
}

<h1>支持</h1>


<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Edit">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="ProposalId" />

            @*<input id="input1" type="text" class="text">*@
            <input class="form-control" id="price" />
            <div class="btn btn-primary btn-lg btn-block" id="paypal-button-container"></div>


            <div id="IsFavorite" class="form-group">
                <label asp-for="IsFavorite" class="control-label"></label>
                <input asp-for="IsFavorite" class="form-control" />
                <span asp-validation-for="IsFavorite" class="text-danger"></span>
            </div>
            <div id="Title" class="form-group">
                <label asp-for="Title" class="control-label"></label>
                <input asp-for="Title" class="form-control" />
                <span asp-validation-for="Title" class="text-danger"></span>
            </div>
            <div id="Summary" class="form-group">
                <label asp-for="Summary" class="control-label"></label>
                <input asp-for="Summary" class="form-control" />
                <span asp-validation-for="Summary" class="text-danger"></span>
            </div>
            <div id="ProjectCover" class="form-group">
                <label asp-for="ProjectCover" class="control-label"></label>
                <input asp-for="ProjectCover" class="form-control" />
                <span asp-validation-for="ProjectCover" class="text-danger"></span>
            </div>
            <div id="TimeStart" class="form-group">
                <label asp-for="TimeStart" class="control-label"></label>
                <input asp-for="TimeStart" class="form-control" />
                <span asp-validation-for="TimeStart" class="text-danger"></span>
            </div>
            <div id="TimeEnd" class="form-group">
                <label asp-for="TimeEnd" class="control-label"></label>
                <input asp-for="TimeEnd" class="form-control" />
                <span asp-validation-for="TimeEnd" class="text-danger"></span>
            </div>
            <div id="Category" class="form-group">
                <label asp-for="Category" class="control-label"></label>
                <input asp-for="Category" class="form-control" />
                <span asp-validation-for="Category" class="text-danger"></span>
            </div>
            <div id="Target" class="form-group">
                <label asp-for="Target" class="control-label"></label>
                <input asp-for="Target" class="form-control" />
                <span asp-validation-for="Target" class="text-danger"></span>
            </div>
            <div id="Video" class="form-group">
                <label asp-for="Video" class="control-label"></label>
                <input asp-for="Video" class="form-control" />
                <span asp-validation-for="Video" class="text-danger"></span>
            </div>
            <div id="Content" class="form-group">
                <label asp-for="Content" class="control-label"></label>
                <input asp-for="Content" class="form-control" />
                <span asp-validation-for="Content" class="text-danger"></span>
            </div>
            <div id="Principal" class="form-group">
                <label asp-for="Principal" class="control-label"></label>
                <input asp-for="Principal" class="form-control" />
                <span asp-validation-for="Principal" class="text-danger"></span>
            </div>
            <div id="Email" class="form-group">
                <label asp-for="Email" class="control-label"></label>
                <input asp-for="Email" class="form-control" />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>
            <div id="Tel" class="form-group">
                <label asp-for="Tel" class="control-label"></label>
                <input asp-for="Tel" class="form-control" />
                <span asp-validation-for="Tel" class="text-danger"></span>
            </div>
            <div id="Identity" class="form-group">
                <label asp-for="Identity" class="control-label"></label>
                <input asp-for="Identity" class="form-control" />
                <span asp-validation-for="Identity" class="text-danger"></span>
            </div>
            <div id="ImgTeam" class="form-group">
                <label asp-for="ImgTeam" class="control-label"></label>
                <input asp-for="ImgTeam" class="form-control" />
                <span asp-validation-for="ImgTeam" class="text-danger"></span>
            </div>
            <div id="DisplayName" class="form-group">
                <label asp-for="DisplayName" class="control-label"></label>
                <input asp-for="DisplayName" class="form-control" />
                <span asp-validation-for="DisplayName" class="text-danger"></span>
            </div>
            <div id="Resume" class="form-group">
                <label asp-for="Resume" class="control-label"></label>
                <input asp-for="Resume" class="form-control" />
                <span asp-validation-for="Resume" class="text-danger"></span>
            </div>
            <div id="FanPage" class="form-group">
                <label asp-for="FanPage" class="control-label"></label>
                <input asp-for="FanPage" class="form-control" />
                <span asp-validation-for="FanPage" class="text-danger"></span>
            </div>
            <div id="Web" class="form-group">
                <label asp-for="Web" class="control-label"></label>
                <input asp-for="Web" class="form-control" />
                <span asp-validation-for="Web" class="text-danger"></span>
            </div>
            <div id="CurrentAmount" class="form-group">
                <label asp-for="CurrentAmount" class="control-label"></label>
                <input id="input2" asp-for="CurrentAmount" class="form-control" />
                <span asp-validation-for="CurrentAmount" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input onclick="Add()" type="submit" value="Save" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<script src="https://www.paypal.com/sdk/js?client-id=ARAl1J1ky754F97mmrR1dD1fTwd_UJ10sNZCoF9RVbfeA8_HqX0O8NfCZYYbUeFoDuxi2lh-VSdsW8pf&currency=USD&disable-funding=credit,card"></script>


@section TopCss {
    <style>
        #CurrentAmount, #Web, #FanPage, #Resume, #DisplayName, #Identity, #ImgTeam, #Tel, #Email, #Principal, #Content, #Video, #Target, #Category, #TimeEnd, #TimeStart, #ProjectCover, #Summary, #Title, #IsFavorite {
            display: none;
        }
    </style>

}

@section Scripts {
    <script>
        function Add() {


            var input1 = document.getElementById("price");

            var input1_num = parseInt(input1.value);

            

            var input2 = document.getElementById("input2");

            var input2_num = parseInt(input2.value);



            
            if (input1.value == null) {

                input2_num += 0;

                input2.value = input2_num;


            }
            else {
                
                input2_num += input1_num;

            input2.value = input2_num;
            }


           
        }

        let sendPaypal = document.querySelector('.send-btn');

        function setPaypal() {
            var args = {
            };
            setTimeout(function () {
                $.ajax({
                    type: "get",
                    url: "/home/paypalOrderID",
                    dataType: "json",
                    data: args,
                    success: function (result) {
                        console.log(result)
                    },
                    error: function () {
                        console.log('error')
                    }
                });
            }, 1000);
        }
        if (sendPaypal) {
            sendPaypal.addEventListener('click', setPaypal);
        }

        paypal.Buttons({
            createOrder: function (data, actions) {
                // This function sets up the details of the transaction, including the amount and line item details.
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: $('#price').val(),

                        }
                    }]
                });
            },
            onApprove: function (data, actions) {
                console.log(data);
                console.log(actions);
                setTimeout(function () {
                    $.ajax({
                        type: "post",
                        url: "home/paypal",
                        dataType: "json",
                        data: data,
                        success: function (result) {
                            console.log(result)
                        },
                        error: function () {
                            console.log('error')
                        }
                    });
                }, 1000);
                // This function captures the funds from the transaction.
                return actions.order.capture().then(function (details) {
                    // This function shows a transaction success message to your buyer.
                    alert('Transaction completed by ' + details.payer.name.given_name);
                });
            }
        }).render('#paypal-button-container');

        let sendPaypal2 = document.querySelector('.btntest');

        function setPaypal2() {
            $.ajax({
                type: "get",
                url: "/home/paypalapproval",
                dataType: "json",
                success: function (result) {
                    console.log(result);
                    window.open(result.rel);
                },
                error: function () {
                    console.log('error')
                }
            });
        }
        sendPaypal2.addEventListener('click', setPaypal2);

        let sendPaypal3 = document.querySelector('.btnss');

        function setPaypal3() {
            $.ajax({
                type: "get",
                url: "/home/paypaltopup",
                dataType: "json",
                success: function (result) {
                    console.log(result);
                    window.open(result.rel);
                },
                error: function () {
                    console.log('error')
                }
            });
        }
        sendPaypal3.addEventListener('click', setPaypal3);
    </script>

}